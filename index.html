<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Crystal Docs 1.16.3">
<meta name="crystal_docs.project_version" content="master">
<meta name="crystal_docs.project_name" content="money">



<link href="css/style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="js/doc.js"></script>

  <meta name="repository-name" content="money">
  <title>money master</title>
  <script type="text/javascript">
  CrystalDocs.base_path = "";
  </script>
</head>
<body>

<svg class="hidden">
  <symbol id="octicon-link" viewBox="0 0 16 16">
    <path fill="currentColor" fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
  </symbol>
</svg>
<input type="checkbox" id="sidebar-btn">
<label for="sidebar-btn" id="sidebar-btn-label">
  <svg class="open" xmlns="http://www.w3.org/2000/svg" height="2em" width="2em" viewBox="0 0 512 512"><title>Open Sidebar</title><path fill="currentColor" d="M80 96v64h352V96H80zm0 112v64h352v-64H80zm0 112v64h352v-64H80z"></path></svg>
  <svg class="close" xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" viewBox="0 0 512 512"><title>Close Sidebar</title><path fill="currentColor" d="m118.6 73.4-45.2 45.2L210.7 256 73.4 393.4l45.2 45.2L256 301.3l137.4 137.3 45.2-45.2L301.3 256l137.3-137.4-45.2-45.2L256 210.7Z"></path></svg>
</label>
<div class="sidebar">
  <div class="sidebar-header">
    <div class="search-box">
      <input type="search" class="search-input" placeholder="Search..." spellcheck="false" aria-label="Search">
    </div>

    <div class="project-summary">
      <h1 class="project-name">
        <a href="index.html">
          money
        </a>
      </h1>

      <span class="project-version">
        master
      </span>
    </div>
  </div>

  <div class="search-results hidden">
    <ul class="search-list"></ul>
  </div>

  <div class="types-list">
    <ul>
  
  <li class=" " data-id="money/Fiber" data-name="fiber">
      <a href="Fiber.html">Fiber</a>
      
    </li>
  
  <li class="parent " data-id="money/Money" data-name="money">
      <a href="Money.html">Money</a>
      
        <ul>
  
  <li class=" " data-id="money/Money/AggregateError" data-name="money::aggregateerror">
      <a href="Money/AggregateError.html">AggregateError</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Allocate" data-name="money::allocate">
      <a href="Money/Allocate.html">Allocate</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Arithmetic" data-name="money::arithmetic">
      <a href="Money/Arithmetic.html">Arithmetic</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Casting" data-name="money::casting">
      <a href="Money/Casting.html">Casting</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Constructors" data-name="money::constructors">
      <a href="Money/Constructors.html">Constructors</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Context" data-name="money::context">
      <a href="Money/Context.html">Context</a>
      
    </li>
  
  <li class="parent " data-id="money/Money/Currency" data-name="money::currency">
      <a href="Money/Currency.html">Currency</a>
      
        <ul>
  
  <li class=" " data-id="money/Money/Currency/Enumeration" data-name="money::currency::enumeration">
      <a href="Money/Currency/Enumeration.html">Enumeration</a>
      
    </li>
  
  <li class="parent " data-id="money/Money/Currency/Exchange" data-name="money::currency::exchange">
      <a href="Money/Currency/Exchange.html">Exchange</a>
      
        <ul>
  
  <li class=" " data-id="money/Money/Currency/Exchange/SingleCurrency" data-name="money::currency::exchange::singlecurrency">
      <a href="Money/Currency/Exchange/SingleCurrency.html">SingleCurrency</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="money/Money/Currency/Loader" data-name="money::currency::loader">
      <a href="Money/Currency/Loader.html">Loader</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/Rate" data-name="money::currency::rate">
      <a href="Money/Currency/Rate.html">Rate</a>
      
    </li>
  
  <li class="parent " data-id="money/Money/Currency/RateProvider" data-name="money::currency::rateprovider">
      <a href="Money/Currency/RateProvider.html">RateProvider</a>
      
        <ul>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/AbstractAPI" data-name="money::currency::rateprovider::abstractapi">
      <a href="Money/Currency/RateProvider/AbstractAPI.html">AbstractAPI</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/Coinlayer" data-name="money::currency::rateprovider::coinlayer">
      <a href="Money/Currency/RateProvider/Coinlayer.html">Coinlayer</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/Compound" data-name="money::currency::rateprovider::compound">
      <a href="Money/Currency/RateProvider/Compound.html">Compound</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/Converter" data-name="money::currency::rateprovider::converter">
      <a href="Money/Currency/RateProvider/Converter.html">Converter</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/CurrencyAPI" data-name="money::currency::rateprovider::currencyapi">
      <a href="Money/Currency/RateProvider/CurrencyAPI.html">CurrencyAPI</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/CurrencyBeacon" data-name="money::currency::rateprovider::currencybeacon">
      <a href="Money/Currency/RateProvider/CurrencyBeacon.html">CurrencyBeacon</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/CurrencyLayer" data-name="money::currency::rateprovider::currencylayer">
      <a href="Money/Currency/RateProvider/CurrencyLayer.html">CurrencyLayer</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/ECB" data-name="money::currency::rateprovider::ecb">
      <a href="Money/Currency/RateProvider/ECB.html">ECB</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/ExchangeRateAPI" data-name="money::currency::rateprovider::exchangerateapi">
      <a href="Money/Currency/RateProvider/ExchangeRateAPI.html">ExchangeRateAPI</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/Fixer" data-name="money::currency::rateprovider::fixer">
      <a href="Money/Currency/RateProvider/Fixer.html">Fixer</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/FloatRates" data-name="money::currency::rateprovider::floatrates">
      <a href="Money/Currency/RateProvider/FloatRates.html">FloatRates</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/FreecurrencyAPI" data-name="money::currency::rateprovider::freecurrencyapi">
      <a href="Money/Currency/RateProvider/FreecurrencyAPI.html">FreecurrencyAPI</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/FXFeed" data-name="money::currency::rateprovider::fxfeed">
      <a href="Money/Currency/RateProvider/FXFeed.html">FXFeed</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/FXRatesAPI" data-name="money::currency::rateprovider::fxratesapi">
      <a href="Money/Currency/RateProvider/FXRatesAPI.html">FXRatesAPI</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/HTTP" data-name="money::currency::rateprovider::http">
      <a href="Money/Currency/RateProvider/HTTP.html">HTTP</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/MetalpriceAPI" data-name="money::currency::rateprovider::metalpriceapi">
      <a href="Money/Currency/RateProvider/MetalpriceAPI.html">MetalpriceAPI</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/MoneyMorph" data-name="money::currency::rateprovider::moneymorph">
      <a href="Money/Currency/RateProvider/MoneyMorph.html">MoneyMorph</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/Null" data-name="money::currency::rateprovider::null">
      <a href="Money/Currency/RateProvider/Null.html">Null</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/OpenExchangeRates" data-name="money::currency::rateprovider::openexchangerates">
      <a href="Money/Currency/RateProvider/OpenExchangeRates.html">OpenExchangeRates</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/UniRateAPI" data-name="money::currency::rateprovider::unirateapi">
      <a href="Money/Currency/RateProvider/UniRateAPI.html">UniRateAPI</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class="parent " data-id="money/Money/Currency/RateStore" data-name="money::currency::ratestore">
      <a href="Money/Currency/RateStore.html">RateStore</a>
      
        <ul>
  
  <li class=" " data-id="money/Money/Currency/RateStore/File" data-name="money::currency::ratestore::file">
      <a href="Money/Currency/RateStore/File.html">File</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateStore/Memory" data-name="money::currency::ratestore::memory">
      <a href="Money/Currency/RateStore/Memory.html">Memory</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="money/Money/Currency/Type" data-name="money::currency::type">
      <a href="Money/Currency/Type.html">Type</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="money/Money/DifferentCurrencyError" data-name="money::differentcurrencyerror">
      <a href="Money/DifferentCurrencyError.html">DifferentCurrencyError</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Error" data-name="money::error">
      <a href="Money/Error.html">Error</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Exchange" data-name="money::exchange">
      <a href="Money/Exchange.html">Exchange</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Formatting" data-name="money::formatting">
      <a href="Money/Formatting.html">Formatting</a>
      
    </li>
  
  <li class="parent " data-id="money/Money/Parse" data-name="money::parse">
      <a href="Money/Parse.html">Parse</a>
      
        <ul>
  
  <li class=" " data-id="money/Money/Parse/Error" data-name="money::parse::error">
      <a href="Money/Parse/Error.html">Error</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="money/Money/RateProviderError" data-name="money::rateprovidererror">
      <a href="Money/RateProviderError.html">RateProviderError</a>
      
    </li>
  
  <li class=" " data-id="money/Money/RateProviderRequestError" data-name="money::rateproviderrequesterror">
      <a href="Money/RateProviderRequestError.html">RateProviderRequestError</a>
      
    </li>
  
  <li class=" " data-id="money/Money/RateProviderRequiredOptionError" data-name="money::rateproviderrequiredoptionerror">
      <a href="Money/RateProviderRequiredOptionError.html">RateProviderRequiredOptionError</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Rounding" data-name="money::rounding">
      <a href="Money/Rounding.html">Rounding</a>
      
    </li>
  
  <li class=" " data-id="money/Money/UndefinedCurrencyError" data-name="money::undefinedcurrencyerror">
      <a href="Money/UndefinedCurrencyError.html">UndefinedCurrencyError</a>
      
    </li>
  
  <li class=" " data-id="money/Money/UndefinedSmallestDenominationError" data-name="money::undefinedsmallestdenominationerror">
      <a href="Money/UndefinedSmallestDenominationError.html">UndefinedSmallestDenominationError</a>
      
    </li>
  
  <li class=" " data-id="money/Money/UnknownCurrencyError" data-name="money::unknowncurrencyerror">
      <a href="Money/UnknownCurrencyError.html">UnknownCurrencyError</a>
      
    </li>
  
  <li class=" " data-id="money/Money/UnknownRateError" data-name="money::unknownrateerror">
      <a href="Money/UnknownRateError.html">UnknownRateError</a>
      
    </li>
  
  <li class=" " data-id="money/Money/UnknownRateProviderError" data-name="money::unknownrateprovidererror">
      <a href="Money/UnknownRateProviderError.html">UnknownRateProviderError</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="money/Number" data-name="number">
      <a href="Number.html">Number</a>
      
    </li>
  
  <li class=" " data-id="money/String" data-name="string">
      <a href="String.html">String</a>
      
    </li>
  
</ul>

  </div>
</div>


<div class="main-content">
<h1><a id="money-ci-releases-license" class="anchor" href="#money-ci-releases-license">  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>money <a href="https://github.com/crystal-money/money/actions/workflows/ci.yml"><img src="https://github.com/crystal-money/money/actions/workflows/ci.yml/badge.svg" alt="CI" /></a> <a href="https://github.com/crystal-money/money/releases"><img src="https://img.shields.io/github/release/crystal-money/money.svg" alt="Releases" /></a> <a href="https://github.com/crystal-money/money/blob/master/LICENSE"><img src="https://img.shields.io/github/license/crystal-money/money.svg" alt="License" /></a></h1>
<p>Hey there! 👋 Welcome to <strong>money</strong>, a Crystal shard for handling money and currency conversion, inspired by <a href="https://github.com/RubyMoney/money">RubyMoney</a>.</p>
<h2><a id="why-use-this-library" class="anchor" href="#why-use-this-library">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Why Use This Library?</h2>
<p>Here’s what you get out of the box:</p>
<ul>
<li>A <code><a href="Money.html">Money</a></code> class to represent amounts and their currencies.</li>
<li>A flexible <code><a href="Money/Currency.html">Money::Currency</a></code> class for all your currency info needs.</li>
<li><code>BigDecimal</code>-based values—no more floating point rounding headaches!</li>
<li>Easy APIs for currency exchange.</li>
<li>Multiple exchange rate providers (use built-in or roll your own).</li>
<li>Formatting and parsing for money values.</li>
<li>Rounding and truncation helpers.</li>
<li>JSON/YAML serialization and deserialization support.</li>
</ul>
<h2><a id="installation" class="anchor" href="#installation">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Installation</h2>
<p>Add this to your application's <code>shard.yml</code>:</p>
<pre><code class="language-yaml">dependencies:
  money:
    github: crystal-money/money</code></pre>
<p>Then run:</p>
<pre><code class="language-shell">shards install</code></pre>
<p>And require it in your project:</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;money&quot;</span></code></pre>
<blockquote>
<p>[!TIP]
If you wish to use YAML serialization, remember to <code>require &quot;yaml&quot;</code>
<strong>before</strong> requiring <code>money</code>.</p>
</blockquote>
<h2><a id="quick-examples" class="anchor" href="#quick-examples">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Quick Examples</h2>
<h3><a id="creating-money" class="anchor" href="#creating-money">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Creating Money</h3>
<blockquote>
<p>[!NOTE]
<code>Money.new</code> first positional argument will treat the given value as the <code>fractional</code>
if it's an integer, and the <code>amount</code> otherwise.</p>
</blockquote>
<pre><code class="language-crystal">money <span class="o">=</span> <span class="t">Money</span>.new(<span class="n">10_00</span>, <span class="s">&quot;USD&quot;</span>)
money.to_s          <span class="c"># =&gt; &quot;$10.00&quot;</span>
money.amount        <span class="c"># =&gt; 10.0</span>
money.fractional    <span class="c"># =&gt; 1000.0</span>
money.currency.code <span class="c"># =&gt; &quot;USD&quot;</span></code></pre>
<h4><a id="from-fractional-amount" class="anchor" href="#from-fractional-amount">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>From fractional amount</h4>
<pre><code class="language-crystal"><span class="t">Money</span>.new(fractional: <span class="n">10.0</span>, currency: <span class="s">&quot;USD&quot;</span>)
<span class="t">Money</span>.new(fractional: <span class="n">10_00</span>, currency: <span class="s">&quot;USD&quot;</span>)
<span class="t">Money</span>.new(<span class="n">10_00</span>, <span class="s">&quot;USD&quot;</span>)</code></pre>
<h4><a id="from-whole-amount" class="anchor" href="#from-whole-amount">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>From whole amount</h4>
<pre><code class="language-crystal"><span class="t">Money</span>.new(amount: <span class="n">10.0</span>, currency: <span class="s">&quot;USD&quot;</span>)
<span class="t">Money</span>.new(amount: <span class="n">10</span>, currency: <span class="s">&quot;USD&quot;</span>)
<span class="t">Money</span>.new(<span class="n">10.0</span>, <span class="s">&quot;USD&quot;</span>)

<span class="t">Money</span>.from_amount(<span class="n">10.0</span>, <span class="s">&quot;USD&quot;</span>)
<span class="t">Money</span>.from_amount(<span class="n">10</span>, <span class="s">&quot;USD&quot;</span>)</code></pre>
<h3><a id="comparing-money" class="anchor" href="#comparing-money">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Comparing Money</h3>
<blockquote>
<p>[!NOTE]
Performs currency conversion if necessary.</p>
</blockquote>
<pre><code class="language-crystal"><span class="t">Money</span>.new(<span class="n">11_00</span>, <span class="s">&quot;USD&quot;</span>) <span class="o">==</span> <span class="t">Money</span>.new(<span class="n">11_00</span>, <span class="s">&quot;USD&quot;</span>) <span class="c"># =&gt; true</span>
<span class="t">Money</span>.new(<span class="n">11_00</span>, <span class="s">&quot;USD&quot;</span>) <span class="o">==</span> <span class="t">Money</span>.new(<span class="n">11_00</span>, <span class="s">&quot;EUR&quot;</span>) <span class="c"># =&gt; false</span>

<span class="t">Money</span>.new(<span class="n">11_00</span>, <span class="s">&quot;USD&quot;</span>) <span class="o">&lt;</span> <span class="t">Money</span>.new(<span class="n">33_00</span>, <span class="s">&quot;USD&quot;</span>) <span class="c"># =&gt; true</span>
<span class="t">Money</span>.new(<span class="n">11_00</span>, <span class="s">&quot;USD&quot;</span>) <span class="o">&gt;</span> <span class="t">Money</span>.new(<span class="n">33_00</span>, <span class="s">&quot;USD&quot;</span>) <span class="c"># =&gt; false</span></code></pre>
<blockquote>
<p>[!CAUTION]
Two <code><a href="Money.html">Money</a></code> objects with <code>0</code> amount are considered equal, regardless of their currency.</p>
</blockquote>
<pre><code class="language-crystal"><span class="t">Money</span>.zero(<span class="s">&quot;USD&quot;</span>) <span class="o">==</span> <span class="t">Money</span>.zero(<span class="s">&quot;EUR&quot;</span>) <span class="c"># =&gt; true</span></code></pre>
<h3><a id="arithmetic" class="anchor" href="#arithmetic">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Arithmetic</h3>
<blockquote>
<p>[!NOTE]
Performs currency conversion if necessary.</p>
</blockquote>
<pre><code class="language-crystal"><span class="t">Money</span>.new(<span class="n">10_00</span>, <span class="s">&quot;USD&quot;</span>) <span class="o">+</span> <span class="t">Money</span>.new(<span class="n">5_00</span>, <span class="s">&quot;USD&quot;</span>) <span class="c"># =&gt; Money(@amount=15.00, @currency=&quot;USD&quot;)</span>
<span class="t">Money</span>.new(<span class="n">22_00</span>, <span class="s">&quot;USD&quot;</span>) <span class="o">-</span> <span class="t">Money</span>.new(<span class="n">2_00</span>, <span class="s">&quot;USD&quot;</span>) <span class="c"># =&gt; Money(@amount=20.00, @currency=&quot;USD&quot;)</span>
<span class="t">Money</span>.new(<span class="n">22_00</span>, <span class="s">&quot;USD&quot;</span>) <span class="o">/</span> <span class="n">2</span>                      <span class="c"># =&gt; Money(@amount=11.00, @currency=&quot;USD&quot;)</span>
<span class="t">Money</span>.new(<span class="n">11_00</span>, <span class="s">&quot;USD&quot;</span>) <span class="o">*</span> <span class="n">5</span>                      <span class="c"># =&gt; Money(@amount=55.00, @currency=&quot;USD&quot;)</span></code></pre>
<h3><a id="unitsubunit-conversions" class="anchor" href="#unitsubunit-conversions">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Unit/Subunit Conversions</h3>
<pre><code class="language-crystal"><span class="t">Money</span>.from_amount(<span class="n">5</span>, <span class="s">&quot;USD&quot;</span>).fractional <span class="c"># =&gt; 500.0</span>
<span class="t">Money</span>.from_amount(<span class="n">5</span>, <span class="s">&quot;JPY&quot;</span>).fractional <span class="c"># =&gt; 5.0</span>
<span class="t">Money</span>.from_amount(<span class="n">5</span>, <span class="s">&quot;TND&quot;</span>).fractional <span class="c"># =&gt; 5000.0</span></code></pre>
<h3><a id="currency-conversion" class="anchor" href="#currency-conversion">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Currency Conversion</h3>
<p>In order to perform currency exchange, you need to set up a <code>Money::Currency::Exchange::RateProvider</code> or add the rates manually:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.default_exchange.rate_store[<span class="s">&quot;USD&quot;</span>, <span class="s">&quot;EUR&quot;</span>] <span class="o">=</span> <span class="n">1.24515</span>
<span class="t">Money</span>.default_exchange.rate_store[<span class="s">&quot;EUR&quot;</span>, <span class="s">&quot;USD&quot;</span>] <span class="o">=</span> <span class="n">0.803115</span></code></pre>
<p>Then you can perform the exchange:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.new(<span class="n">1_00</span>, <span class="s">&quot;USD&quot;</span>).exchange_to(<span class="s">&quot;EUR&quot;</span>) <span class="c"># =&gt; Money(@amount=1.24, @currency=&quot;EUR&quot;)</span>
<span class="t">Money</span>.new(<span class="n">1_00</span>, <span class="s">&quot;EUR&quot;</span>).exchange_to(<span class="s">&quot;USD&quot;</span>) <span class="c"># =&gt; Money(@amount=0.8, @currency=&quot;USD&quot;)</span></code></pre>
<p>Comparison and arithmetic operations work as expected:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.new(<span class="n">10_00</span>, <span class="s">&quot;EUR&quot;</span>) <span class="o">==</span> <span class="t">Money</span>.new(<span class="n">10_00</span>, <span class="s">&quot;USD&quot;</span>) <span class="c"># =&gt; false</span>
<span class="t">Money</span>.new(<span class="n">10_00</span>, <span class="s">&quot;EUR&quot;</span>) <span class="o">+</span> <span class="t">Money</span>.new(<span class="n">10_00</span>, <span class="s">&quot;USD&quot;</span>)  <span class="c"># =&gt; Money(@amount=22.45, @currency=&quot;EUR&quot;)</span></code></pre>
<h3><a id="formatting" class="anchor" href="#formatting">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Formatting</h3>
<pre><code class="language-crystal"><span class="t">Money</span>.new(<span class="n">1_00</span>, <span class="s">&quot;USD&quot;</span>).format <span class="c"># =&gt; &quot;$1.00&quot;</span>
<span class="t">Money</span>.new(<span class="n">1_00</span>, <span class="s">&quot;GBP&quot;</span>).format <span class="c"># =&gt; &quot;£1.00&quot;</span>
<span class="t">Money</span>.new(<span class="n">1_00</span>, <span class="s">&quot;EUR&quot;</span>).format <span class="c"># =&gt; &quot;€1.00&quot;</span></code></pre>
<h3><a id="money-ranges" class="anchor" href="#money-ranges">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Money Ranges</h3>
<pre><code class="language-crystal">range <span class="o">=</span> <span class="t">Money</span>.new(<span class="n">1_00</span>, <span class="s">&quot;USD&quot;</span>)..<span class="t">Money</span>.new(<span class="n">3_00</span>, <span class="s">&quot;USD&quot;</span>)
range.to_a(<span class="o">&amp;</span>.to_s)
<span class="c"># =&gt; [&quot;$1.00&quot;, &quot;$1.01&quot;, &quot;$1.02&quot;, ..., &quot;$2.99&quot;, &quot;$3.00&quot;]</span></code></pre>
<h4><a id="steppable-ranges" class="anchor" href="#steppable-ranges">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Steppable Ranges</h4>
<pre><code class="language-crystal">range <span class="o">=</span> <span class="t">Money</span>.new(<span class="n">1_00</span>, <span class="s">&quot;USD&quot;</span>)..<span class="t">Money</span>.new(<span class="n">3_00</span>, <span class="s">&quot;USD&quot;</span>)
range
  .step(by: <span class="t">Money</span>.new(<span class="n">1_00</span>, <span class="s">&quot;USD&quot;</span>))
  .to_a(<span class="o">&amp;</span>.to_s)
<span class="c"># =&gt; [&quot;$1.00&quot;, &quot;$2.00&quot;, &quot;$3.00&quot;]</span></code></pre>
<h2><a id="infinite-precision" class="anchor" href="#infinite-precision">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Infinite Precision</h2>
<p>By default, <code><a href="Money.html">Money</a></code> objects are rounded to the nearest cent and the extra precision
is <strong>not</strong> preserved:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.new(<span class="n">2.34567</span>).to_s <span class="c"># =&gt; &quot;$2.35&quot;</span></code></pre>
<p>If you want to keep all the digits, you can enable infinite precision globally:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.infinite_precision <span class="o">=</span> <span class="n">true</span>
<span class="t">Money</span>.new(<span class="n">2.34567</span>).to_s <span class="c"># =&gt; &quot;$2.34567&quot;</span></code></pre>
<p>Or use the block-scoped <code>Money.with_infinite_precision</code>:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.with_infinite_precision <span class="k">do</span>
  <span class="t">Money</span>.new(<span class="n">2.34567</span>).to_s <span class="c"># =&gt; &quot;$2.34567&quot;</span>
<span class="k">end</span></code></pre>
<h2><a id="currencies" class="anchor" href="#currencies">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Currencies</h2>
<p>A <code><a href="Money/Currency.html">Money::Currency</a></code> instance holds all the info about the currency:</p>
<pre><code class="language-crystal">currency <span class="o">=</span> <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.find(<span class="s">&quot;USD&quot;</span>)
currency.code   <span class="c"># =&gt; &quot;USD&quot;</span>
currency.name   <span class="c"># =&gt; &quot;United States Dollar&quot;</span>
currency.symbol <span class="c"># =&gt; &quot;$&quot;</span>
currency.fiat?  <span class="c"># =&gt; true</span></code></pre>
<p>Most APIs let you use a <code><a href="String.html">String</a></code>, <code>Symbol</code>, or a <code><a href="Money/Currency.html">Money::Currency</a></code>:</p>
<pre><code class="language-crystal"><span class="c"># All of the following are equivalent:</span>

<span class="t">Money</span>.default_currency <span class="o">=</span> <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.find(<span class="s">&quot;CAD&quot;</span>)
<span class="t">Money</span>.default_currency <span class="o">=</span> <span class="s">&quot;CAD&quot;</span>
<span class="t">Money</span>.default_currency <span class="o">=</span> <span class="n">:cad</span></code></pre>
<h3><a id="currency-lookup" class="anchor" href="#currency-lookup">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Currency Lookup</h3>
<p><code>Money::Currency.find</code> and <code>Money::Currency.[]</code> methods let you find a currency by its code:</p>
<pre><code class="language-crystal"><span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.find(<span class="s">&quot;USD&quot;</span>) <span class="c"># =&gt; #&lt;Money::Currency @code=&quot;USD&quot;&gt;</span>
<span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>[<span class="n">:usd</span>]       <span class="c"># =&gt; #&lt;Money::Currency @code=&quot;USD&quot;&gt;</span>
<span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>[<span class="n">:foo</span>]       <span class="c"># raises Money::UnknownCurrencyError</span></code></pre>
<p>There are also <code>Money::Currency.find?</code> and <code>Money::Currency.[]?</code> non-raising methods:</p>
<pre><code class="language-crystal"><span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.find?(<span class="s">&quot;USD&quot;</span>) <span class="c"># =&gt; #&lt;Money::Currency @code=&quot;USD&quot;&gt;</span>
<span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>[<span class="n">:usd</span>]?       <span class="c"># =&gt; #&lt;Money::Currency @code=&quot;USD&quot;&gt;</span>
<span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>[<span class="n">:foo</span>]?       <span class="c"># =&gt; nil</span></code></pre>
<h3><a id="currency-enumeration" class="anchor" href="#currency-enumeration">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Currency Enumeration</h3>
<blockquote>
<p>[!TIP]
<code><a href="Money/Currency.html">Money::Currency</a></code> class implements <code>Enumerable</code> module, so you can use all of its
methods like <code>each</code>, <code>map</code>, <code>find</code>, <code>select</code>, etc.</p>
</blockquote>
<p>For example, to find a currency by ISO 4217 numeric code:</p>
<pre><code class="language-crystal"><span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.find(<span class="o">&amp;</span>.iso_numeric.<span class="o">==</span>(<span class="n">978</span>)) <span class="c"># =&gt; #&lt;Money::Currency @code=&quot;EUR&quot;&gt;</span></code></pre>
<p>Or to select all the ISO currencies:</p>
<pre><code class="language-crystal"><span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.<span class="k">select</span>(<span class="o">&amp;</span>.iso?)
<span class="c"># =&gt; [#&lt;Money::Currency @code=&quot;USD&quot;&gt;, #&lt;Money::Currency @code=&quot;EUR&quot;&gt;, ...]</span></code></pre>
<p>In addition, there are <code>Money::Currency.metal</code>, <code>Money::Currency.fiat</code> and
<code>Money::Currency.crypto</code> methods to get all the currencies of a particular <code>type</code>:</p>
<pre><code class="language-crystal"><span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.metal
<span class="c"># =&gt; [#&lt;Money::Currency @code=&quot;XAG&quot;&gt;, #&lt;Money::Currency @code=&quot;XAU&quot;&gt;, ...]</span>
<span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.fiat
<span class="c"># =&gt; [#&lt;Money::Currency @code=&quot;USD&quot;&gt;, #&lt;Money::Currency @code=&quot;EUR&quot;&gt;, ...]</span>
<span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.crypto
<span class="c"># =&gt; [#&lt;Money::Currency @code=&quot;BTC&quot;&gt;, #&lt;Money::Currency @code=&quot;ETH&quot;&gt;, ...]</span>

<span class="c"># or</span>
<span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.reject(<span class="o">&amp;</span>.metal?)
<span class="c"># =&gt; [#&lt;Money::Currency @code=&quot;USD&quot;&gt;, #&lt;Money::Currency @code=&quot;EUR&quot;&gt;, ...]</span></code></pre>
<p>To return an array of registered currencies (ordered by their priority),
call <code>Money::Currency.all</code> or <code>.to_a</code>:</p>
<pre><code class="language-crystal"><span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.all <span class="c"># =&gt; [#&lt;Money::Currency @code=&quot;USD&quot;&gt;, #&lt;Money::Currency @code=&quot;EUR&quot;&gt;, ...]</span></code></pre>
<h3><a id="registering-a-new-currency" class="anchor" href="#registering-a-new-currency">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Registering a New Currency</h3>
<pre><code class="language-crystal">currency <span class="o">=</span> <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.new(
  <span class="k">type</span>:                <span class="n">:fiat</span>,
  priority:            <span class="n">1</span>,
  code:                <span class="s">&quot;USD&quot;</span>,
  iso_numeric:         <span class="n">840</span>,
  name:                <span class="s">&quot;United States Dollar&quot;</span>,
  symbol:              <span class="s">&quot;$&quot;</span>,
  symbol_first:        <span class="n">true</span>,
  subunit:             <span class="s">&quot;Cent&quot;</span>,
  subunit_to_unit:     <span class="n">100</span>,
  decimal_mark:        <span class="s">&quot;.&quot;</span>,
  thousands_separator: <span class="s">&quot;,&quot;</span>
)

<span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.register(currency)</code></pre>
<h4><a id="currency-attributes" class="anchor" href="#currency-attributes">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Currency Attributes</h4>
<ul>
<li><code>:type</code> — a <code><a href="Money/Currency/Type.html">Money::Currency::Type</a></code> - either <code>Metal</code>, <code>Fiat</code> or <code>Crypto</code></li>
<li><code>:priority</code> — a numerical value you can use to sort/group the currency list</li>
<li><code>:code</code> — the international 3-letter code as defined by the ISO 4217 standard</li>
<li><code>:iso_numeric</code> — the international 3-digit code as defined by the ISO 4217 standard</li>
<li><code>:name</code> — the currency name</li>
<li><code>:symbol</code> — the currency symbol (UTF-8 encoded)</li>
<li><code>:symbol_first</code> — whether a money symbol should go before the amount</li>
<li><code>:subunit</code> — the name of the fractional monetary unit</li>
<li><code>:subunit_to_unit</code> — the proportion between the unit and the subunit</li>
<li><code>:decimal_mark</code> — character between the whole and fraction amounts</li>
<li><code>:thousands_separator</code> — character between each thousands place</li>
</ul>
<p>All attributes except <code>:code</code> and <code>:subunit_to_unit</code> are optional.</p>
<h4><a id="priority" class="anchor" href="#priority">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Priority</h4>
<p>You can use the <code>priority</code> attribute to sort or group currencies:</p>
<pre><code class="language-crystal"><span class="c"># Returns an array of currencies where priority is less than 10</span>
<span class="k">def</span> <span class="m">major_currencies</span>(currencies)
  currencies.take_while(<span class="o">&amp;</span>.priority.try(<span class="o">&amp;</span>.<span class="o">&lt;</span>(<span class="n">10</span>)))
<span class="k">end</span>

major_currencies(<span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>)
<span class="c"># =&gt; [#&lt;Money::Currency @code=&quot;USD&quot;&gt;, #&lt;Money::Currency @code=&quot;EUR&quot;&gt;, ...]</span></code></pre>
<h3><a id="default-currency" class="anchor" href="#default-currency">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Default Currency</h3>
<p>By default, <code><a href="Money.html">Money</a></code> does not have a default currency. You can set it like so:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.default_currency <span class="o">=</span> <span class="n">:xag</span></code></pre>
<h3><a id="currency-exponent" class="anchor" href="#currency-exponent">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Currency Exponent</h3>
<p>The exponent of a money value is the number of digits after the decimal
separator (which separates the major unit from the minor unit). See e.g.
<a href="https://www.iso.org/iso-4217-currency-codes.html">ISO 4217</a> for more information.</p>
<pre><code class="language-crystal"><span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.find(<span class="s">&quot;USD&quot;</span>).exponent <span class="c"># =&gt; 2</span>
<span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.find(<span class="s">&quot;JPY&quot;</span>).exponent <span class="c"># =&gt; 0</span>
<span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.find(<span class="s">&quot;MGA&quot;</span>).exponent <span class="c"># =&gt; 1</span></code></pre>
<h2><a id="currency-exchange" class="anchor" href="#currency-exchange">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Currency Exchange</h2>
<p>Exchanging money is performed through a <code><a href="Money/Currency/Exchange.html">Money::Currency::Exchange</a></code> object.
This is done by fetching the exchange rate from a <code>#rate_store</code> first.
If the rate is not available (or stale), it is then fetched from a <code>#rate_provider</code>.</p>
<p>The default <code><a href="Money/Currency/Exchange.html">Money::Currency::Exchange</a></code> object uses <code>Memory</code> rate store
in conjunction with <code>Null</code> rate provider, which requires one to manually
specify the exchange rate.</p>
<p>Here's an example of how it works:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.default_exchange.rate_store[<span class="s">&quot;USD&quot;</span>, <span class="s">&quot;EUR&quot;</span>] <span class="o">=</span> <span class="n">1.24515</span>
<span class="t">Money</span>.default_exchange.rate_store[<span class="s">&quot;EUR&quot;</span>, <span class="s">&quot;USD&quot;</span>] <span class="o">=</span> <span class="n">0.803115</span>

<span class="t">Money</span>.new(<span class="n">1_00</span>, <span class="s">&quot;USD&quot;</span>).exchange_to(<span class="s">&quot;EUR&quot;</span>) <span class="c"># =&gt; Money(@amount=1.24, @currency=&quot;EUR&quot;)</span>
<span class="t">Money</span>.new(<span class="n">1_00</span>, <span class="s">&quot;EUR&quot;</span>).exchange_to(<span class="s">&quot;USD&quot;</span>) <span class="c"># =&gt; Money(@amount=0.8, @currency=&quot;USD&quot;)</span></code></pre>
<h3><a id="exchange-rate-stores" class="anchor" href="#exchange-rate-stores">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Exchange Rate Stores</h3>
<p>The default exchange uses an in-memory store:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.default_exchange <span class="o">=</span> <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span><span class="t">::</span><span class="t">Exchange</span>.new(
  rate_store: <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span><span class="t">::</span><span class="t">RateStore</span><span class="t">::</span><span class="t">Memory</span>.new
)</code></pre>
<p>Rate stores can be configured with <code>Time::Span</code> controlling the time-to-live (TTL)
of the exchange rates:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.default_exchange <span class="o">=</span> <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span><span class="t">::</span><span class="t">Exchange</span>.new(
  rate_store: <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span><span class="t">::</span><span class="t">RateStore</span><span class="t">::</span><span class="t">Memory</span>.new(ttl: <span class="n">1</span>.hour)
)</code></pre>
<p>Or use your own store (database, file, cache, etc):</p>
<pre><code class="language-crystal"><span class="t">Money</span>.default_exchange.rate_store <span class="o">=</span> <span class="t">MyCustomStore</span>.new</code></pre>
<p>The store can be used directly:</p>
<pre><code class="language-crystal"><span class="c"># Add to the underlying store</span>
<span class="t">Money</span>.default_exchange.rate_store[<span class="s">&quot;USD&quot;</span>, <span class="s">&quot;CAD&quot;</span>] <span class="o">=</span> <span class="n">0.9</span>

<span class="c"># Retrieve from the underlying store</span>
<span class="t">Money</span>.default_exchange.rate_store[<span class="s">&quot;USD&quot;</span>, <span class="s">&quot;CAD&quot;</span>] <span class="c"># =&gt; 0.9</span></code></pre>
<p>As long as the store holds the exchange rates, <code><a href="Money.html">Money</a></code> will use them.</p>
<pre><code class="language-crystal"><span class="t">Money</span>.new(<span class="n">10_00</span>, <span class="s">&quot;USD&quot;</span>).exchange_to(<span class="s">&quot;CAD&quot;</span>)        <span class="c"># =&gt; Money(@amount=9.0 @currency=&quot;CAD&quot;)</span>
<span class="t">Money</span>.new(<span class="n">10_00</span>, <span class="s">&quot;CAD&quot;</span>) <span class="o">+</span> <span class="t">Money</span>.new(<span class="n">10_00</span>, <span class="s">&quot;USD&quot;</span>) <span class="c"># =&gt; Money(@amount=19.0 @currency=&quot;CAD&quot;)</span></code></pre>
<h3><a id="exchange-rate-providers" class="anchor" href="#exchange-rate-providers">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Exchange Rate Providers</h3>
<p>By default, the exchange uses a <code>Null</code> provider, which returns <code>nil</code> for all rates.</p>
<pre><code class="language-crystal"><span class="t">Money</span>.default_exchange <span class="o">=</span> <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span><span class="t">::</span><span class="t">Exchange</span>.new(
  rate_provider: <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span><span class="t">::</span><span class="t">RateProvider</span><span class="t">::</span><span class="t">Null</span>.new
)</code></pre>
<p>There are multiple providers available under the <code><a href="Money/Currency/RateProvider.html">Money::Currency::RateProvider</a></code>
<a href="https://github.com/crystal-money/money/tree/master/src/money/currency/rate_provider">namespace</a>
which can be used OOTB to fetch exchange rates from different sources.</p>
<p>You can choose one of them, roll your own, or combine them with the <code>Compound</code> provider:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.default_exchange.rate_provider <span class="o">=</span>
  <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span><span class="t">::</span><span class="t">RateProvider</span><span class="t">::</span><span class="t">Compound</span>.new([
    <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span><span class="t">::</span><span class="t">RateProvider</span><span class="t">::</span><span class="t">ECB</span>.new,
    <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span><span class="t">::</span><span class="t">RateProvider</span><span class="t">::</span><span class="t">FloatRates</span>.new,
    <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span><span class="t">::</span><span class="t">RateProvider</span><span class="t">::</span><span class="t">UniRateAPI</span>.new(
      api_key: <span class="s">&quot;valid-api-key&quot;</span>
    ),
  ])</code></pre>
<blockquote>
<p>[!TIP]
<code>Compound</code> rate provider takes an array of <code><a href="Money/Currency/RateProvider.html">Money::Currency::RateProvider</a></code> instances
which are used in order to fetch the exchange rate.</p>
</blockquote>
<h3><a id="disabling-currency-conversion" class="anchor" href="#disabling-currency-conversion">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Disabling Currency Conversion</h3>
<p>If you want to prevent automatic currency conversion:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.disallow_currency_conversion!</code></pre>
<h2><a id="rounding" class="anchor" href="#rounding">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Rounding</h2>
<p>By default, <code><a href="Money.html">Money</a></code> rounds to the nearest cent:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.new(<span class="n">2.34567</span>).to_s <span class="c"># =&gt; &quot;$2.35&quot;</span></code></pre>
<p>You can change the rounding precision:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.new(<span class="n">2.34567</span>).round(<span class="n">1</span>).to_s <span class="c"># =&gt; &quot;$2.30&quot;</span></code></pre>
<p>You can change the rounding mode:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.new(<span class="n">2.34567</span>).round(<span class="n">1</span>, <span class="n">:to_positive</span>).to_s <span class="c"># =&gt; &quot;$2.40&quot;</span>
<span class="t">Money</span>.new(<span class="n">2.34567</span>).round(<span class="n">1</span>, <span class="n">:to_negative</span>).to_s <span class="c"># =&gt; &quot;$2.30&quot;</span></code></pre>
<p>To keep extra digits, enable infinite precision:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.infinite_precision <span class="o">=</span> <span class="n">true</span>

<span class="t">Money</span>.new(<span class="n">2.34567</span>).to_s                    <span class="c"># =&gt; &quot;$2.34567&quot;</span>
<span class="t">Money</span>.new(<span class="n">2.34567</span>).round(<span class="n">4</span>).to_s           <span class="c"># =&gt; &quot;$2.3457&quot;</span>
<span class="t">Money</span>.new(<span class="n">2.34567</span>).round(<span class="n">4</span>, <span class="n">:to_zero</span>).to_s <span class="c"># =&gt; &quot;$2.3456&quot;</span>

<span class="c"># or</span>

<span class="t">Money</span>.with_rounding_mode(<span class="n">:to_zero</span>) <span class="k">do</span>
  <span class="t">Money</span>.new(<span class="n">2.34567</span>).round(<span class="n">4</span>).to_s         <span class="c"># =&gt; &quot;$2.3456&quot;</span>
<span class="k">end</span></code></pre>
<h3><a id="nearest-cash-value" class="anchor" href="#nearest-cash-value">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Nearest Cash Value</h3>
<p>If you want to round to the nearest cash value, use <code>Money#round_to_nearest_cash_value</code>:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.new(<span class="n">10_07</span>, <span class="s">&quot;CHF&quot;</span>).round_to_nearest_cash_value
<span class="c"># =&gt; Money(@amount=10.05, @currency=&quot;CHF&quot;)</span>

<span class="t">Money</span>.new(<span class="n">10_08</span>, <span class="s">&quot;CHF&quot;</span>).round_to_nearest_cash_value
<span class="c"># =&gt; Money(@amount=10.1, @currency=&quot;CHF&quot;)</span></code></pre>
<h2><a id="jsonyaml-serialization" class="anchor" href="#jsonyaml-serialization">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>JSON/YAML Serialization</h2>
<p><code><a href="Money.html">Money</a></code>, <code><a href="Money/Currency.html">Money::Currency</a></code>, <code><a href="Money/Currency/Rate.html">Money::Currency::Rate</a></code> and <code><a href="Money/Currency/RateProvider.html">Money::Currency::RateProvider</a></code> implements <code>JSON::Serializable</code> and <code>YAML::Serializable</code>:</p>
<h3><a id="money" class="anchor" href="#money">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code><a href="Money.html">Money</a></code></h3>
<pre><code class="language-crystal"><span class="t">Money</span>.new(<span class="n">10_00</span>, <span class="s">&quot;USD&quot;</span>).to_json <span class="c"># =&gt; &quot;{\&quot;amount\&quot;:10.0,\&quot;currency\&quot;:\&quot;USD\&quot;}&quot;</span>
<span class="t">Money</span>.new(<span class="n">10_00</span>, <span class="s">&quot;USD&quot;</span>).to_yaml <span class="c"># =&gt; &quot;---\namount: 10.0\ncurrency: USD\n&quot;</span>

<span class="t">Money</span>.from_json(<span class="s">%({&quot;amount&quot;: 10.0, &quot;currency&quot;: &quot;USD&quot;})</span>)
<span class="c"># =&gt; Money(@amount=10.0, @currency=&quot;USD&quot;)</span>

<span class="t">Money</span>.from_yaml(<span class="s">&quot;{ amount: 10.0, currency: USD }&quot;</span>)
<span class="c"># =&gt; Money(@amount=10.0, @currency=&quot;USD&quot;)</span></code></pre>
<h3><a id="moneycurrency" class="anchor" href="#moneycurrency">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code><a href="Money/Currency.html">Money::Currency</a></code></h3>
<pre><code class="language-crystal"><span class="c"># Serialize existing `Money::Currency`</span>

<span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.find(<span class="s">&quot;USD&quot;</span>).to_json <span class="c"># =&gt; &quot;{\&quot;code\&quot;:\&quot;USD\&quot;, ...}&quot;</span>
<span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.find(<span class="s">&quot;USD&quot;</span>).to_yaml <span class="c"># =&gt; &quot;---\ncode: USD\n ...&quot;</span>

<span class="c"># Instantiate new `Money::Currency`</span>

<span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.from_json(<span class="s">%({&quot;code&quot;: &quot;FOO&quot;, ...})</span>) <span class="c"># =&gt; #&lt;Money::Currency @code=&quot;FOO&quot;&gt;</span>
<span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.from_yaml(<span class="s">&quot;{ code: FOO, ... }&quot;</span>)    <span class="c"># =&gt; #&lt;Money::Currency @code=&quot;FOO&quot;&gt;</span>

<span class="c"># Lookup existing `Money::Currency`</span>

<span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.from_json(<span class="s">%(&quot;USD&quot;)</span>) <span class="c"># =&gt; #&lt;Money::Currency @code=&quot;USD&quot;&gt;</span>
<span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.from_yaml(<span class="s">&quot;USD&quot;</span>)    <span class="c"># =&gt; #&lt;Money::Currency @code=&quot;USD&quot;&gt;</span></code></pre>
<h3><a id="moneycurrencyrate" class="anchor" href="#moneycurrencyrate">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code><a href="Money/Currency/Rate.html">Money::Currency::Rate</a></code></h3>
<pre><code class="language-crystal">rate <span class="o">=</span> <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span><span class="t">::</span><span class="t">Rate</span>.new(
  <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.find(<span class="s">&quot;USD&quot;</span>),
  <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.find(<span class="s">&quot;EUR&quot;</span>),
  <span class="n">1.25</span>.to_big_d,
  <span class="t">Time</span>.parse_utc(<span class="s">&quot;2025-05-22&quot;</span>, <span class="s">&quot;%F&quot;</span>),
)

rate.to_json <span class="c"># =&gt; &quot;{\&quot;base\&quot;:\&quot;USD\&quot;,\&quot;target\&quot;:\&quot;EUR\&quot;,\&quot;value\&quot;:1.25,\&quot;updated_at\&quot;:\&quot;2025-05-22T00:00:00.000Z\&quot;}&quot;</span>
rate.to_yaml <span class="c"># =&gt; &quot;---\nbase: USD\ntarget: EUR\nvalue: 1.25\nupdated_at: 2025-05-22\n&quot;</span></code></pre>
<h3><a id="moneycurrencyrate-provider" class="anchor" href="#moneycurrencyrate-provider">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code><a href="Money/Currency/RateProvider.html">Money::Currency::RateProvider</a></code></h3>
<p>You can use <code>.from_json</code> and <code>.from_yaml</code> methods to deserialize generic
rate provider instances providing the <code>name</code> (in <em>CamelCase</em> or <em>snake_case</em>)
and <code>options</code> - optional hash that's being passed to the provider initializer.</p>
<pre><code class="language-crystal">provider <span class="o">=</span> <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span><span class="t">::</span><span class="t">RateProvider</span>.from_yaml <span class="s">&lt;&lt;-YAML</span>
<span class="s">  name: Compound
  options:
    providers:
    - name: ECB
    - name: FloatRates
    - name: UniRateAPI
      options:
        api_key: valid-api-key
  YAML</span>

provider.<span class="k">class</span> <span class="c"># =&gt; Money::Currency::RateProvider::Compound</span></code></pre>
<p>For specific providers you pass the <code>options</code> directly:</p>
<pre><code class="language-crystal">compound_provider <span class="o">=</span> <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span><span class="t">::</span><span class="t">RateProvider</span><span class="t">::</span><span class="t">Compound</span>.from_yaml <span class="s">&lt;&lt;-YAML</span>
<span class="s">  providers:
  - name: ECB
  - name: FloatRates
  YAML</span>

compound_provider.providers <span class="o">&lt;&lt;</span> <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span><span class="t">::</span><span class="t">RateProvider</span><span class="t">::</span><span class="t">UniRateAPI</span>.from_yaml <span class="s">&lt;&lt;-YAML</span>
<span class="s">  api_key: valid-api-key
  YAML</span>

compound_provider.providers.size <span class="c"># =&gt; 3</span></code></pre>
<h4><a id="using-with-jsonserializable-and-yamlserializable" class="anchor" href="#using-with-jsonserializable-and-yamlserializable">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Using with <code>JSON::Serializable</code> and <code>YAML::Serializable</code></h4>
<p>In order to (de)serialize generic <code><a href="Money/Currency/RateProvider.html">Money::Currency::RateProvider</a></code> instances,
you need to add a <code>JSON/YAML::Field</code> annotation with a custom converter —
<code><a href="Money/Currency/RateProvider/Converter.html">Money::Currency::RateProvider::Converter</a></code>.</p>
<pre><code class="language-crystal"><span class="k">class</span> <span class="t">FooWithGenericProvider</span>
  <span class="k">include</span> <span class="t">JSON</span><span class="t">::</span><span class="t">Serializable</span>
  <span class="k">include</span> <span class="t">YAML</span><span class="t">::</span><span class="t">Serializable</span>

  @[<span class="t">JSON</span><span class="t">::</span><span class="t">Field</span>(converter: <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span><span class="t">::</span><span class="t">RateProvider</span><span class="t">::</span><span class="t">Converter</span>)]
  @[<span class="t">YAML</span><span class="t">::</span><span class="t">Field</span>(converter: <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span><span class="t">::</span><span class="t">RateProvider</span><span class="t">::</span><span class="t">Converter</span>)]
  property provider : <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span><span class="t">::</span><span class="t">RateProvider</span>

  <span class="k">def</span> <span class="m">initialize</span>(@provider)
  <span class="k">end</span>
<span class="k">end</span>

foo <span class="o">=</span> <span class="t">FooWithGenericProvider</span>.from_yaml <span class="s">&lt;&lt;-YAML</span>
<span class="s">  provider:
    name: Compound
    options:
      providers:
      - name: ECB
      - name: FloatRates
      - name: UniRateAPI
        options:
          api_key: valid-api-key
  YAML</span>

foo.provider.<span class="k">class</span> <span class="c"># =&gt; Money::Currency::RateProvider::Compound</span></code></pre>
<h2><a id="working-with-fibers" class="anchor" href="#working-with-fibers">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Working with Fibers</h2>
<p>Global settings are being kept in a single, fiber-local <code>Money.context</code> object,
and are not shared between fibers by default.</p>
<p>Use this to <code>spawn</code> a fiber with the same settings as the current one:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.default_currency <span class="o">=</span> <span class="s">&quot;EUR&quot;</span>

<span class="t">Money</span>.spawn_with_same_context <span class="k">do</span>
  <span class="t">Money</span>.default_currency.code <span class="c"># =&gt; &quot;EUR&quot;</span>
<span class="k">end</span></code></pre>
<p>All of the <code><a href="Money.html">Money</a></code> APIs and classes are (or at least should be) fiber-safe.</p>
<blockquote>
<p>[!CAUTION]
<code>Money.spawn_with_same_context</code> duplicates the <code>Money.context</code> instance,
by calling <code>#dup</code> on it and thus only the values are being duplicated,
references are shared.</p>
</blockquote>
<h2><a id="formatting-1" class="anchor" href="#formatting-1">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Formatting</h2>
<p>There are several formatting rules for when <code>Money#format</code> is called. For more info, check out the <a href="https://github.com/crystal-money/money/blob/master/src/money/money/formatting.cr">formatting module source</a>, or the <a href="https://crystal-money.github.io/money/Money/Formatting.html">docs</a>.</p>
<p>If you want to format money according to the EU's <a href="https://style-guide.europa.eu/en/content/-/isg/topic?identifier=7.3.3-rules-for-expressing-monetary-units#id370303__id370303_PositionISO">Rules for expressing monetary units</a>:</p>
<pre><code class="language-crystal">money <span class="o">=</span> <span class="t">Money</span>.new(<span class="n">1_23</span>, <span class="s">&quot;GBP&quot;</span>)                       <span class="c"># =&gt; Money(@amount=1.23 @currency=&quot;GBP&quot;)</span>
money.format(format: <span class="s">&quot;%{currency} %{sign}%{amount}&quot;</span>) <span class="c"># =&gt; &quot;GBP 1.23&quot;</span></code></pre>
<h2><a id="parsing" class="anchor" href="#parsing">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Parsing</h2>
<p>You can parse a string with an amount and currency code or symbol:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.parse(<span class="s">&quot;$12.34&quot;</span>)    <span class="c"># =&gt; Money(@amount=12.34, @currency=&quot;USD&quot;)</span>
<span class="t">Money</span>.parse(<span class="s">&quot;12.34 USD&quot;</span>) <span class="c"># =&gt; Money(@amount=12.34, @currency=&quot;USD&quot;)</span></code></pre>
<h2><a id="contributors" class="anchor" href="#contributors">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Contributors</h2>
<ul>
<li><a href="https://github.com/Sija">Sija</a> Sijawusz Pur Rahnama (creator &amp; maintainer)</li>
</ul>
</div>
</body>
</html>
