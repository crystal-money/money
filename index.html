<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Crystal Docs 1.15.1">
<meta name="crystal_docs.project_version" content="master">
<meta name="crystal_docs.project_name" content="money">



<link href="css/style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="js/doc.js"></script>

  <meta name="repository-name" content="money">
  <title>money master</title>
  <script type="text/javascript">
  CrystalDocs.base_path = "";
  </script>
</head>
<body>

<svg class="hidden">
  <symbol id="octicon-link" viewBox="0 0 16 16">
    <path fill="currentColor" fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
  </symbol>
</svg>
<input type="checkbox" id="sidebar-btn">
<label for="sidebar-btn" id="sidebar-btn-label">
  <svg class="open" xmlns="http://www.w3.org/2000/svg" height="2em" width="2em" viewBox="0 0 512 512"><title>Open Sidebar</title><path fill="currentColor" d="M80 96v64h352V96H80zm0 112v64h352v-64H80zm0 112v64h352v-64H80z"></path></svg>
  <svg class="close" xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" viewBox="0 0 512 512"><title>Close Sidebar</title><path fill="currentColor" d="m118.6 73.4-45.2 45.2L210.7 256 73.4 393.4l45.2 45.2L256 301.3l137.4 137.3 45.2-45.2L301.3 256l137.3-137.4-45.2-45.2L256 210.7Z"></path></svg>
</label>
<div class="sidebar">
  <div class="sidebar-header">
    <div class="search-box">
      <input type="search" class="search-input" placeholder="Search..." spellcheck="false" aria-label="Search">
    </div>

    <div class="project-summary">
      <h1 class="project-name">
        <a href="index.html">
          money
        </a>
      </h1>

      <span class="project-version">
        master
      </span>
    </div>
  </div>

  <div class="search-results hidden">
    <ul class="search-list"></ul>
  </div>

  <div class="types-list">
    <ul>
  
  <li class=" " data-id="money/BigDecimal" data-name="bigdecimal">
      <a href="BigDecimal.html">BigDecimal</a>
      
    </li>
  
  <li class=" " data-id="money/Fiber" data-name="fiber">
      <a href="Fiber.html">Fiber</a>
      
    </li>
  
  <li class="parent " data-id="money/Money" data-name="money">
      <a href="Money.html">Money</a>
      
        <ul>
  
  <li class=" " data-id="money/Money/Allocate" data-name="money::allocate">
      <a href="Money/Allocate.html">Allocate</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Arithmetic" data-name="money::arithmetic">
      <a href="Money/Arithmetic.html">Arithmetic</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Casting" data-name="money::casting">
      <a href="Money/Casting.html">Casting</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Constructors" data-name="money::constructors">
      <a href="Money/Constructors.html">Constructors</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Context" data-name="money::context">
      <a href="Money/Context.html">Context</a>
      
    </li>
  
  <li class="parent " data-id="money/Money/Currency" data-name="money::currency">
      <a href="Money/Currency.html">Currency</a>
      
        <ul>
  
  <li class=" " data-id="money/Money/Currency/Enumeration" data-name="money::currency::enumeration">
      <a href="Money/Currency/Enumeration.html">Enumeration</a>
      
    </li>
  
  <li class="parent " data-id="money/Money/Currency/Exchange" data-name="money::currency::exchange">
      <a href="Money/Currency/Exchange.html">Exchange</a>
      
        <ul>
  
  <li class=" " data-id="money/Money/Currency/Exchange/SingleCurrency" data-name="money::currency::exchange::singlecurrency">
      <a href="Money/Currency/Exchange/SingleCurrency.html">SingleCurrency</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="money/Money/Currency/Loader" data-name="money::currency::loader">
      <a href="Money/Currency/Loader.html">Loader</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/Rate" data-name="money::currency::rate">
      <a href="Money/Currency/Rate.html">Rate</a>
      
    </li>
  
  <li class="parent " data-id="money/Money/Currency/RateProvider" data-name="money::currency::rateprovider">
      <a href="Money/Currency/RateProvider.html">RateProvider</a>
      
        <ul>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/AbstractAPI" data-name="money::currency::rateprovider::abstractapi">
      <a href="Money/Currency/RateProvider/AbstractAPI.html">AbstractAPI</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/Coinlayer" data-name="money::currency::rateprovider::coinlayer">
      <a href="Money/Currency/RateProvider/Coinlayer.html">Coinlayer</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/Compound" data-name="money::currency::rateprovider::compound">
      <a href="Money/Currency/RateProvider/Compound.html">Compound</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/CurrencyAPI" data-name="money::currency::rateprovider::currencyapi">
      <a href="Money/Currency/RateProvider/CurrencyAPI.html">CurrencyAPI</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/CurrencyBeacon" data-name="money::currency::rateprovider::currencybeacon">
      <a href="Money/Currency/RateProvider/CurrencyBeacon.html">CurrencyBeacon</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/ECB" data-name="money::currency::rateprovider::ecb">
      <a href="Money/Currency/RateProvider/ECB.html">ECB</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/ExchangeRateAPI" data-name="money::currency::rateprovider::exchangerateapi">
      <a href="Money/Currency/RateProvider/ExchangeRateAPI.html">ExchangeRateAPI</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/Fixer" data-name="money::currency::rateprovider::fixer">
      <a href="Money/Currency/RateProvider/Fixer.html">Fixer</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/FloatRates" data-name="money::currency::rateprovider::floatrates">
      <a href="Money/Currency/RateProvider/FloatRates.html">FloatRates</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/Freecurrency" data-name="money::currency::rateprovider::freecurrency">
      <a href="Money/Currency/RateProvider/Freecurrency.html">Freecurrency</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/FXFeed" data-name="money::currency::rateprovider::fxfeed">
      <a href="Money/Currency/RateProvider/FXFeed.html">FXFeed</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/FXRatesAPI" data-name="money::currency::rateprovider::fxratesapi">
      <a href="Money/Currency/RateProvider/FXRatesAPI.html">FXRatesAPI</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/HTTP" data-name="money::currency::rateprovider::http">
      <a href="Money/Currency/RateProvider/HTTP.html">HTTP</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/MetalpriceAPI" data-name="money::currency::rateprovider::metalpriceapi">
      <a href="Money/Currency/RateProvider/MetalpriceAPI.html">MetalpriceAPI</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/MoneyMorph" data-name="money::currency::rateprovider::moneymorph">
      <a href="Money/Currency/RateProvider/MoneyMorph.html">MoneyMorph</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/Null" data-name="money::currency::rateprovider::null">
      <a href="Money/Currency/RateProvider/Null.html">Null</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/OpenExchangeRates" data-name="money::currency::rateprovider::openexchangerates">
      <a href="Money/Currency/RateProvider/OpenExchangeRates.html">OpenExchangeRates</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateProvider/UniRate" data-name="money::currency::rateprovider::unirate">
      <a href="Money/Currency/RateProvider/UniRate.html">UniRate</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class="parent " data-id="money/Money/Currency/RateStore" data-name="money::currency::ratestore">
      <a href="Money/Currency/RateStore.html">RateStore</a>
      
        <ul>
  
  <li class=" " data-id="money/Money/Currency/RateStore/File" data-name="money::currency::ratestore::file">
      <a href="Money/Currency/RateStore/File.html">File</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Currency/RateStore/Memory" data-name="money::currency::ratestore::memory">
      <a href="Money/Currency/RateStore/Memory.html">Memory</a>
      
    </li>
  
</ul>

      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="money/Money/DifferentCurrencyError" data-name="money::differentcurrencyerror">
      <a href="Money/DifferentCurrencyError.html">DifferentCurrencyError</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Error" data-name="money::error">
      <a href="Money/Error.html">Error</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Exchange" data-name="money::exchange">
      <a href="Money/Exchange.html">Exchange</a>
      
    </li>
  
  <li class=" " data-id="money/Money/Formatting" data-name="money::formatting">
      <a href="Money/Formatting.html">Formatting</a>
      
    </li>
  
  <li class="parent " data-id="money/Money/Mixin" data-name="money::mixin">
      <a href="Money/Mixin.html">Mixin</a>
      
        <ul>
  
  <li class=" " data-id="money/Money/Mixin/InitializeWith" data-name="money::mixin::initializewith">
      <a href="Money/Mixin/InitializeWith.html">InitializeWith</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class="parent " data-id="money/Money/Parse" data-name="money::parse">
      <a href="Money/Parse.html">Parse</a>
      
        <ul>
  
  <li class=" " data-id="money/Money/Parse/Error" data-name="money::parse::error">
      <a href="Money/Parse/Error.html">Error</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="money/Money/UndefinedSmallestDenominationError" data-name="money::undefinedsmallestdenominationerror">
      <a href="Money/UndefinedSmallestDenominationError.html">UndefinedSmallestDenominationError</a>
      
    </li>
  
  <li class=" " data-id="money/Money/UnknownCurrencyError" data-name="money::unknowncurrencyerror">
      <a href="Money/UnknownCurrencyError.html">UnknownCurrencyError</a>
      
    </li>
  
  <li class=" " data-id="money/Money/UnknownRateError" data-name="money::unknownrateerror">
      <a href="Money/UnknownRateError.html">UnknownRateError</a>
      
    </li>
  
  <li class=" " data-id="money/Money/UnknownRateProviderError" data-name="money::unknownrateprovidererror">
      <a href="Money/UnknownRateProviderError.html">UnknownRateProviderError</a>
      
    </li>
  
</ul>

      
    </li>
  
</ul>

  </div>
</div>


<div class="main-content">
<h1><a id="money-ci-releases-license" class="anchor" href="#money-ci-releases-license">  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>money <a href="https://github.com/crystal-money/money/actions/workflows/ci.yml"><img src="https://github.com/crystal-money/money/actions/workflows/ci.yml/badge.svg" alt="CI" /></a> <a href="https://github.com/crystal-money/money/releases"><img src="https://img.shields.io/github/release/crystal-money/money.svg" alt="Releases" /></a> <a href="https://github.com/crystal-money/money/blob/master/LICENSE"><img src="https://img.shields.io/github/license/crystal-money/money.svg" alt="License" /></a></h1>
<h2><a id="introduction" class="anchor" href="#introduction">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Introduction</h2>
<p>A Crystal shard for dealing with money and currency conversion inspired by <a href="https://github.com/RubyMoney/money">RubyMoney</a>.</p>
<h3><a id="features" class="anchor" href="#features">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Features</h3>
<ul>
<li>Provides a <code><a href="Money.html">Money</a></code> class which encapsulates all information about an certain
amount of money, such as its value and its currency.</li>
<li>Provides a <code><a href="Money/Currency.html">Money::Currency</a></code> class which encapsulates all information about
a monetary unit.</li>
<li>Represents monetary values as big decimals. This avoids floating point
rounding errors.</li>
<li>Represents currency as <code><a href="Money/Currency.html">Money::Currency</a></code> instances providing a high level of
flexibility.</li>
<li>Provides APIs for exchanging money from one currency to another.</li>
</ul>
<h3><a id="resources" class="anchor" href="#resources">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Resources</h3>
<ul>
<li><a href="https://crystal-money.github.io/money/">API Documentation</a></li>
<li><a href="https://github.com/crystal-money/money">Git Repository</a></li>
</ul>
<h3><a id="notes" class="anchor" href="#notes">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Notes</h3>
<ul>
<li>Your app must use UTF-8 to function with this library. There are a
number of non-ASCII currency attributes.</li>
<li>This app requires JSON.</li>
</ul>
<h2><a id="installation" class="anchor" href="#installation">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Installation</h2>
<p>Add this to your application's <code>shard.yml</code>:</p>
<pre><code class="language-yaml">dependencies:
  money:
    github: crystal-money/money</code></pre>
<p>Install with <code>shards install</code>.</p>
<h2><a id="usage" class="anchor" href="#usage">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Usage</h2>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;money&quot;</span>

<span class="c"># 10.00 USD</span>
money <span class="o">=</span> <span class="t">Money</span>.new(<span class="n">1000</span>, <span class="s">&quot;USD&quot;</span>)
money.amount        <span class="c"># =&gt; 10.0</span>
money.fractional    <span class="c"># =&gt; 1000.0</span>
money.currency.code <span class="c"># =&gt; &quot;USD&quot;</span>

<span class="c"># Comparisons</span>
<span class="t">Money</span>.new(<span class="n">1000</span>, <span class="s">&quot;USD&quot;</span>) <span class="o">==</span> <span class="t">Money</span>.new(<span class="n">1000</span>, <span class="s">&quot;USD&quot;</span>) <span class="c"># =&gt; true</span>
<span class="t">Money</span>.new(<span class="n">1000</span>, <span class="s">&quot;USD&quot;</span>) <span class="o">==</span> <span class="t">Money</span>.new(<span class="n">100</span>,  <span class="s">&quot;USD&quot;</span>) <span class="c"># =&gt; false</span>
<span class="t">Money</span>.new(<span class="n">1000</span>, <span class="s">&quot;USD&quot;</span>) <span class="o">==</span> <span class="t">Money</span>.new(<span class="n">1000</span>, <span class="s">&quot;EUR&quot;</span>) <span class="c"># =&gt; false</span>
<span class="t">Money</span>.new(<span class="n">1000</span>, <span class="s">&quot;USD&quot;</span>) <span class="o">!=</span> <span class="t">Money</span>.new(<span class="n">1000</span>, <span class="s">&quot;EUR&quot;</span>) <span class="c"># =&gt; true</span>

<span class="c"># Arithmetic</span>
<span class="t">Money</span>.new(<span class="n">1000</span>, <span class="s">&quot;USD&quot;</span>) <span class="o">+</span> <span class="t">Money</span>.new(<span class="n">500</span>, <span class="s">&quot;USD&quot;</span>) <span class="o">==</span> <span class="t">Money</span>.new(<span class="n">1500</span>, <span class="s">&quot;USD&quot;</span>)
<span class="t">Money</span>.new(<span class="n">1000</span>, <span class="s">&quot;USD&quot;</span>) <span class="o">-</span> <span class="t">Money</span>.new(<span class="n">200</span>, <span class="s">&quot;USD&quot;</span>) <span class="o">==</span> <span class="t">Money</span>.new(<span class="n">800</span>,  <span class="s">&quot;USD&quot;</span>)
<span class="t">Money</span>.new(<span class="n">1000</span>, <span class="s">&quot;USD&quot;</span>) <span class="o">/</span> <span class="n">5</span>                     <span class="o">==</span> <span class="t">Money</span>.new(<span class="n">200</span>,  <span class="s">&quot;USD&quot;</span>)
<span class="t">Money</span>.new(<span class="n">1000</span>, <span class="s">&quot;USD&quot;</span>) <span class="o">*</span> <span class="n">5</span>                     <span class="o">==</span> <span class="t">Money</span>.new(<span class="n">5000</span>, <span class="s">&quot;USD&quot;</span>)

<span class="c"># Unit to subunit conversions</span>
<span class="t">Money</span>.from_amount(<span class="n">5</span>, <span class="s">&quot;USD&quot;</span>) <span class="o">==</span> <span class="t">Money</span>.new(<span class="n">500</span>,  <span class="s">&quot;USD&quot;</span>) <span class="c"># 5 USD</span>
<span class="t">Money</span>.from_amount(<span class="n">5</span>, <span class="s">&quot;JPY&quot;</span>) <span class="o">==</span> <span class="t">Money</span>.new(<span class="n">5</span>,    <span class="s">&quot;JPY&quot;</span>) <span class="c"># 5 JPY</span>
<span class="t">Money</span>.from_amount(<span class="n">5</span>, <span class="s">&quot;TND&quot;</span>) <span class="o">==</span> <span class="t">Money</span>.new(<span class="n">5000</span>, <span class="s">&quot;TND&quot;</span>) <span class="c"># 5 TND</span>

<span class="c"># Currency conversions</span>
some_code_to_setup_exchange_rates
<span class="t">Money</span>.new(<span class="n">1000</span>, <span class="s">&quot;USD&quot;</span>).exchange_to(<span class="s">&quot;EUR&quot;</span>) <span class="o">==</span> <span class="t">Money</span>.new(some_value, <span class="s">&quot;EUR&quot;</span>)

<span class="c"># Formatting (see Formatting section for more options)</span>
<span class="t">Money</span>.new(<span class="n">100</span>, <span class="s">&quot;USD&quot;</span>).format <span class="c"># =&gt; &quot;$1.00&quot;</span>
<span class="t">Money</span>.new(<span class="n">100</span>, <span class="s">&quot;GBP&quot;</span>).format <span class="c"># =&gt; &quot;£1.00&quot;</span>
<span class="t">Money</span>.new(<span class="n">100</span>, <span class="s">&quot;EUR&quot;</span>).format <span class="c"># =&gt; &quot;€1.00&quot;</span>

<span class="c"># Steppable ranges</span>
(<span class="t">Money</span>.new(<span class="n">1_00</span>, <span class="s">&quot;USD&quot;</span>)..<span class="t">Money</span>.new(<span class="n">3_00</span>, <span class="s">&quot;USD&quot;</span>))
  .step(by: <span class="t">Money</span>.new(<span class="n">1_00</span>, <span class="s">&quot;USD&quot;</span>))
  .map(<span class="o">&amp;</span>.to_s)
  .to_a
<span class="c"># =&gt; [&quot;$1.00&quot;, &quot;$2.00&quot;, &quot;$3.00&quot;]</span></code></pre>
<h2><a id="infinite-precision" class="anchor" href="#infinite-precision">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Infinite Precision</h2>
<p>By default, <code><a href="Money.html">Money</a></code> objects are rounded to the nearest cent and the additional
precision is not preserved:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.new(<span class="n">2.34567</span>).to_s <span class="c"># =&gt; &quot;$2.35&quot;</span></code></pre>
<p>If you wish to work with the additional precision, you can use either of the
following:</p>
<pre><code class="language-crystal"><span class="c"># Set the value globally</span>
<span class="t">Money</span>.infinite_precision <span class="o">=</span> <span class="n">true</span>

<span class="t">Money</span>.new(<span class="n">2.34567</span>).to_s   <span class="c"># =&gt; &quot;$2.34567&quot;</span>

<span class="c"># or</span>

<span class="c"># Set the value within the block</span>
<span class="t">Money</span>.with_infinite_precision <span class="k">do</span>
  <span class="t">Money</span>.new(<span class="n">2.34567</span>).to_s <span class="c"># =&gt; &quot;$2.34567&quot;</span>
<span class="k">end</span></code></pre>
<h2><a id="currency" class="anchor" href="#currency">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Currency</h2>
<p>Currencies are consistently represented as instances of <code><a href="Money/Currency.html">Money::Currency</a></code>.
The most part of <code><a href="Money.html">Money</a></code> APIs allows you to supply either a <code>String</code>, <code>Symbol</code>
or a <code><a href="Money/Currency.html">Money::Currency</a></code>.</p>
<pre><code class="language-crystal"><span class="t">Money</span>.new(<span class="n">1000</span>, <span class="s">&quot;USD&quot;</span>) <span class="o">==</span> <span class="t">Money</span>.new(<span class="n">1000</span>, <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.find(<span class="s">&quot;USD&quot;</span>))
<span class="t">Money</span>.new(<span class="n">1000</span>, <span class="s">&quot;EUR&quot;</span>).currency <span class="o">==</span> <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.find(<span class="n">:eur</span>)
<span class="t">Money</span>.new(<span class="n">1000</span>, <span class="s">&quot;PLN&quot;</span>).currency <span class="o">==</span> <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>[<span class="n">:pln</span>]</code></pre>
<p>A <code><a href="Money/Currency.html">Money::Currency</a></code> instance holds all the information about the currency,
including the currency symbol, name and much more.</p>
<pre><code class="language-crystal">currency <span class="o">=</span> <span class="t">Money</span>.new(<span class="n">1000</span>, <span class="s">&quot;USD&quot;</span>).currency
currency.code <span class="c"># =&gt; &quot;USD&quot;</span>
currency.name <span class="c"># =&gt; &quot;United States Dollar&quot;</span></code></pre>
<p>To define a new <code><a href="Money/Currency.html">Money::Currency</a></code> use <code>Money::Currency.register</code> as shown
below.</p>
<pre><code class="language-crystal">currency <span class="o">=</span> <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.new(
  priority:            <span class="n">1</span>,
  code:                <span class="s">&quot;USD&quot;</span>,
  iso_numeric:         <span class="n">840</span>,
  name:                <span class="s">&quot;United States Dollar&quot;</span>,
  symbol:              <span class="s">&quot;$&quot;</span>,
  symbol_first:        <span class="n">true</span>,
  subunit:             <span class="s">&quot;Cent&quot;</span>,
  subunit_to_unit:     <span class="n">100</span>,
  decimal_mark:        <span class="s">&quot;.&quot;</span>,
  thousands_separator: <span class="s">&quot;,&quot;</span>
)

<span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.register(currency)</code></pre>
<p>The pre-defined set of attributes includes:</p>
<ul>
<li><code>:priority</code> a numerical value you can use to sort/group the currency list</li>
<li><code>:code</code> the international 3-letter code as defined by the ISO 4217 standard</li>
<li><code>:iso_numeric</code> the international 3-digit code as defined by the ISO 4217 standard</li>
<li><code>:name</code> the currency name</li>
<li><code>:symbol</code> the currency symbol (UTF-8 encoded)</li>
<li><code>:symbol_first</code> whether a money symbol should go before the amount</li>
<li><code>:subunit</code> the name of the fractional monetary unit</li>
<li><code>:subunit_to_unit</code> the proportion between the unit and the subunit</li>
<li><code>:decimal_mark</code> character between the whole and fraction amounts</li>
<li><code>:thousands_separator</code> character between each thousands place</li>
</ul>
<p>All attributes except <code>:code</code> and <code>:subunit_to_unit</code> are optional.
Some attributes, such as <code>:symbol</code>, are used by the <code><a href="Money.html">Money</a></code> class to print out a
representation of the object. Other attributes, such as <code>:name</code> or <code>:priority</code>,
exist to provide a basic API you can take advantage of to build your application.</p>
<h3><a id="priority" class="anchor" href="#priority">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>:priority</h3>
<p>The priority attribute is an arbitrary numerical value you can assign to the
<code><a href="Money/Currency.html">Money::Currency</a></code> and use in sorting/grouping operation.</p>
<p>For instance, let's assume your web application needs to render a currency
selector like the one available <a href="https://finance.yahoo.com/currency-converter/">here</a>.
You can create a couple of custom methods to return the list of major currencies and
all currencies as follows:</p>
<pre><code class="language-crystal"><span class="c"># Returns an array of currency id where priority &lt; 10</span>
<span class="k">def</span> <span class="m">major_currencies</span>(hash)
  hash.values.sort.take_while(<span class="o">&amp;</span>.priority.try(<span class="o">&amp;</span>.<span class="o">&lt;</span>(<span class="n">10</span>))).map(<span class="o">&amp;</span>.id)
<span class="k">end</span>

<span class="c"># Returns an array of all currency id</span>
<span class="k">def</span> <span class="m">all_currencies</span>(hash)
  hash.keys
<span class="k">end</span>

major_currencies(<span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.table)
<span class="c"># =&gt; [&quot;usd&quot;, &quot;eur&quot;, &quot;gbp&quot;, &quot;aud&quot;, &quot;cad&quot;, &quot;jpy&quot;]</span>

all_currencies(<span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.table)
<span class="c"># =&gt; [&quot;aed&quot;, &quot;afn&quot;, &quot;all&quot;, ...]</span></code></pre>
<h3><a id="default-currency" class="anchor" href="#default-currency">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Default Currency</h3>
<p>By default <code><a href="Money.html">Money</a></code> defaults to USD as its currency. This can be overwritten
using:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.default_currency <span class="o">=</span> <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.find(<span class="s">&quot;CAD&quot;</span>)
<span class="c"># or</span>
<span class="t">Money</span>.default_currency <span class="o">=</span> <span class="n">:cad</span></code></pre>
<h3><a id="currency-exponent" class="anchor" href="#currency-exponent">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Currency Exponent</h3>
<p>The exponent of a money value is the number of digits after the decimal
separator (which separates the major unit from the minor unit). See e.g.
<a href="https://www.iso.org/iso-4217-currency-codes.html">ISO 4217</a> for more
information. You can find the exponent (as an <code>Int32</code>) by</p>
<pre><code class="language-crystal"><span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.find(<span class="s">&quot;USD&quot;</span>).exponent <span class="c"># =&gt; 2</span>
<span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.find(<span class="s">&quot;JPY&quot;</span>).exponent <span class="c"># =&gt; 0</span>
<span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.find(<span class="s">&quot;MGA&quot;</span>).exponent <span class="c"># =&gt; 1</span></code></pre>
<h3><a id="currency-lookup" class="anchor" href="#currency-lookup">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Currency Lookup</h3>
<p>To find a given currency by ISO 4217 numeric code (three digits) you can do</p>
<pre><code class="language-crystal"><span class="t">Money</span><span class="t">::</span><span class="t">Currency</span>.find(<span class="o">&amp;</span>.iso_numeric.<span class="o">==</span>(<span class="n">978</span>)) <span class="c"># =&gt; #&lt;Money::Currency @iso_numeric=978, @code=&quot;EUR&quot;, @name=&quot;Euro&quot;, @symbol=&quot;€&quot;, @subunit=&quot;Cent&quot;, @subunit_to_unit=100, @symbol_first=true ...&gt;</span></code></pre>
<h2><a id="currency-exchange" class="anchor" href="#currency-exchange">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Currency Exchange</h2>
<p>Exchanging money is performed through a <code>Currency::Exchange</code> object.
This is done by fetching the exchange rate from a <code>Currency::Exchange#rate_store</code>
object. If the rate is not available (or stale), it is then fetched from a
<code>Currency::Exchange#rate_provider</code>.</p>
<p>The default <code>Currency::Exchange</code> object uses <code>Currency::RateStore::Memory</code>
in conjunction with <code>Currency::RateProvider::Null</code> which requires one to
manually specify the exchange rate.</p>
<p>Here's an example of how it works:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.default_exchange.rate_store[<span class="s">&quot;USD&quot;</span>, <span class="s">&quot;EUR&quot;</span>] <span class="o">=</span> <span class="n">1.24515</span>
<span class="t">Money</span>.default_exchange.rate_store[<span class="s">&quot;EUR&quot;</span>, <span class="s">&quot;USD&quot;</span>] <span class="o">=</span> <span class="n">0.803115</span>

<span class="t">Money</span>.new(<span class="n">100</span>, <span class="s">&quot;USD&quot;</span>).exchange_to(<span class="s">&quot;EUR&quot;</span>) <span class="c"># =&gt; Money.new(@amount=1.24, @currency=&quot;EUR&quot;)</span>
<span class="t">Money</span>.new(<span class="n">100</span>, <span class="s">&quot;EUR&quot;</span>).exchange_to(<span class="s">&quot;USD&quot;</span>) <span class="c"># =&gt; Money.new(@amount=0.8,  @currency=&quot;USD&quot;)</span></code></pre>
<p>Comparison and arithmetic operations work as expected:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.new(<span class="n">1000</span>, <span class="s">&quot;USD&quot;</span>) <span class="o">&lt;=&gt;</span> <span class="t">Money</span>.new(<span class="n">900</span>, <span class="s">&quot;USD&quot;</span>) <span class="c"># =&gt; 1; 9.00 USD is smaller</span>
<span class="t">Money</span>.new(<span class="n">1000</span>, <span class="s">&quot;EUR&quot;</span>) <span class="o">+</span> <span class="t">Money</span>.new(<span class="n">10</span>, <span class="s">&quot;EUR&quot;</span>)    <span class="c"># =&gt; Money.new(@amount=10.1, @currency=&quot;EUR&quot;)</span>

<span class="t">Money</span>.default_exchange.rate_store[<span class="s">&quot;USD&quot;</span>, <span class="s">&quot;EUR&quot;</span>] <span class="o">=</span> <span class="n">0.5</span>
<span class="t">Money</span>.new(<span class="n">1000</span>, <span class="s">&quot;EUR&quot;</span>) <span class="o">+</span> <span class="t">Money</span>.new(<span class="n">1000</span>, <span class="s">&quot;USD&quot;</span>) <span class="c"># =&gt; Money.new(@amount=15.0, @currency=&quot;EUR&quot;)</span></code></pre>
<h3><a id="exchange-rate-stores" class="anchor" href="#exchange-rate-stores">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Exchange rate stores</h3>
<p>The default exchange is initialized with an in-memory store for exchange rates.</p>
<pre><code class="language-crystal"><span class="t">Money</span>.default_exchange <span class="o">=</span> <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span><span class="t">::</span><span class="t">Exchange</span>.new(
  store: <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span><span class="t">::</span><span class="t">RateStore</span><span class="t">::</span><span class="t">Memory</span>.new
)</code></pre>
<p>Rate stores can be configured with <code>Time::Span</code> controlling the time-to-live (TTL)
of the exchange rates:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.default_exchange <span class="o">=</span> <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span><span class="t">::</span><span class="t">Exchange</span>.new(
  store: <span class="t">Money</span><span class="t">::</span><span class="t">Currency</span><span class="t">::</span><span class="t">RateStore</span><span class="t">::</span><span class="t">Memory</span>.new(ttl: <span class="n">1</span>.hour)
)</code></pre>
<p>You can pass you own store implementation, ie. for storing and retrieving rates off a database, file, cache, etc.</p>
<pre><code class="language-crystal"><span class="t">Money</span>.default_exchange.rate_store <span class="o">=</span> <span class="t">MyCustomStore</span>.new

<span class="c"># Add to the underlying store</span>
<span class="t">Money</span>.default_exchange.rate_store[<span class="s">&quot;USD&quot;</span>, <span class="s">&quot;CAD&quot;</span>] <span class="o">=</span> <span class="n">0.9</span>

<span class="c"># Retrieve from the underlying store</span>
<span class="t">Money</span>.default_exchange.rate_store[<span class="s">&quot;USD&quot;</span>, <span class="s">&quot;CAD&quot;</span>] <span class="c"># =&gt; 0.9</span>

<span class="c"># Exchanging amounts just works</span>
<span class="t">Money</span>.new(<span class="n">10.0</span>, <span class="s">&quot;USD&quot;</span>).exchange_to(<span class="s">&quot;CAD&quot;</span>) <span class="c"># =&gt; Money(@amount=9.0 @currency=&quot;CAD&quot;)</span></code></pre>
<h3><a id="exchange-rate-providers" class="anchor" href="#exchange-rate-providers">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Exchange rate providers</h3>
<p>The default exchange is initialized with a <code>Currency::RateProvider::Null</code> provider,
which returns <code>nil</code> for all exchange rates.</p>
<p>There is nothing stopping you from creating rate provider object which scrapes
<a href="https://www.xe.com">XE</a> for the current rates or just returns <code>rand(2)</code>:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.default_exchange.rate_provider <span class="o">=</span> <span class="t">XeDotComProvider</span>.new</code></pre>
<h3><a id="disabling-currency-conversion" class="anchor" href="#disabling-currency-conversion">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Disabling currency conversion</h3>
<p>If you wish to disable automatic currency conversion to prevent arithmetic when
currencies don't match:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.disallow_currency_conversion!</code></pre>
<h2><a id="rounding" class="anchor" href="#rounding">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Rounding</h2>
<p>By default, <code><a href="Money.html">Money</a></code> objects are rounded to the nearest cent and the additional precision is not preserved:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.new(<span class="n">2.34567</span>).to_s <span class="c"># =&gt; &quot;$2.35&quot;</span></code></pre>
<p>To round to the nearest cent (or anything more precise), you can use the <code>Money#round</code> method.</p>
<pre><code class="language-crystal"><span class="t">Money</span>.new(<span class="n">2.34567</span>).round(<span class="n">4</span>).to_s <span class="c"># =&gt; &quot;$2.35&quot;</span></code></pre>
<p>To retain the additional precision, you will also need to set <code>Money.infinite_precision</code> to <code>true</code>.</p>
<pre><code class="language-crystal"><span class="t">Money</span>.infinite_precision <span class="o">=</span> <span class="n">true</span>

<span class="t">Money</span>.new(<span class="n">2.34567</span>).to_s                    <span class="c"># =&gt; &quot;$2.3457&quot;</span>
<span class="t">Money</span>.new(<span class="n">2.34567</span>).round(<span class="n">4</span>, <span class="n">:to_zero</span>).to_s <span class="c"># =&gt; &quot;$2.3456&quot;</span>

<span class="c"># or</span>

<span class="t">Money</span>.with_rounding_mode(<span class="n">:to_zero</span>) <span class="k">do</span>
  <span class="t">Money</span>.new(<span class="n">2.34567</span>).round(<span class="n">4</span>).to_s         <span class="c"># =&gt; &quot;$2.3456&quot;</span>
<span class="k">end</span></code></pre>
<h2><a id="working-with-fibers" class="anchor" href="#working-with-fibers">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Working with fibers</h2>
<p>By default, global settings are not shared between fibers. You can use the
<code>Money.spawn_with_same_context</code> to spawn a new fiber with the same global settings:</p>
<pre><code class="language-crystal"><span class="t">Money</span>.default_currency <span class="o">=</span> <span class="s">&quot;EUR&quot;</span>

<span class="t">Money</span>.spawn_with_same_context <span class="k">do</span>
  <span class="t">Money</span>.default_currency.code <span class="c"># =&gt; &quot;EUR&quot;</span>
<span class="k">end</span></code></pre>
<h2><a id="formatting" class="anchor" href="#formatting">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Formatting</h2>
<p>There are several formatting rules for when <code>Money#format</code> is called. For more information, check out the <a href="https://github.com/crystal-money/money/blob/master/src/money/money/formatting.cr">formatting module source</a>, or read the latest release's <a href="https://crystal-money.github.io/money/Money/Formatting.html">docs</a>.</p>
<p>If you wish to format money according to the EU's <a href="https://style-guide.europa.eu/en/content/-/isg/topic?identifier=7.3.3-rules-for-expressing-monetary-units#id370303__id370303_PositionISO">Rules for expressing monetary units</a> in either English, Irish, Latvian or Maltese:</p>
<pre><code class="language-crystal">money <span class="o">=</span> <span class="t">Money</span>.new(<span class="n">123</span>, <span class="n">:gbp</span>)               <span class="c"># =&gt; Money(@amount=1.23 @currency=&quot;GBP&quot;)</span>
money.format(symbol: <span class="s">&quot;</span><span class="i">#{</span>money.currency<span class="i">}</span><span class="s"> &quot;</span>) <span class="c"># =&gt; &quot;GBP 1.23&quot;</span></code></pre>
<h2><a id="heuristics" class="anchor" href="#heuristics">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Heuristics</h2>
<p>To parse a <code>String</code> containing amount with currency code or symbol you can do</p>
<pre><code class="language-crystal"><span class="t">Money</span>.parse(<span class="s">&quot;$12.34&quot;</span>)    <span class="c"># =&gt; Money(@amount=12.34, @currency=&quot;USD&quot;)</span>
<span class="t">Money</span>.parse(<span class="s">&quot;12.34 USD&quot;</span>) <span class="c"># =&gt; Money(@amount=12.34, @currency=&quot;USD&quot;)</span></code></pre>
<h2><a id="contributors" class="anchor" href="#contributors">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Contributors</h2>
<ul>
<li><a href="https://github.com/Sija">Sija</a> Sijawusz Pur Rahnama - creator, maintainer</li>
</ul>
</div>
</body>
</html>
